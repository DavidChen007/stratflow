
server {
    listen 80;
    server_name localhost;

    # 前端静态资源 - /stratflow/ 路径
    location /stratflow/ {
        alias /usr/share/nginx/html/;
        index index.html index.htm;
        try_files $uri $uri/ /stratflow/index.html;

        # Ensure correct MIME type for modules
        location ~* \.(tsx|ts|js)$ {
            add_header Content-Type text/javascript;
        }
    }

    # 兼容根路径访问（可选，重定向到 /stratflow/）
    location = / {
        return 301 /stratflow/;
    }

    # K8s 部署：API 请求由 Ingress 直接路由到后端 Service
    # 前端 nginx 不需要代理 API 请求

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }
}
